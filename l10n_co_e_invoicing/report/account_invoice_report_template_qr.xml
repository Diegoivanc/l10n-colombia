<?xml version="1.0"?>
<odoo>
<data>
<template id="report_invoice_qr">
<t t-name="account_facturas.exa_original_document_with_QR" >
    <t t-foreach="docs" t-as="o">
        <t t-set="o" t-value="o.with_context({'lang':o.partner_id.lang})"/>
        <div class="page" style="font-size:12px">
            <div class="qrcode">
			    		<t t-foreach="o.dian_document_lines" t-as="ddl">
                            <t t-if="ddl.state == 'done'">
                                <div style="width:100px;height:100px;float:left;">
                                    <img t-att-src="'/report/barcode/QR/%s' % ddl.qr_information" style="width:100px;height:100px;margin-bottom:5px"/>
                                </div>
                            </t>
                        </t>									
	       	</div>
            <div class="row">
                <table width="100%" style="border:1px solid gray;">
                    <tr>
                        <td>
                            <strong>Cliente: </strong>
                            <span t-esc="o.partner_id.name"/>
                        </td>
                        <td align="right">
                            <strong>NIT: </strong>
                            <span t-esc="o.partner_id.vat"/>
                        </td>
                    </tr>
                </table>
            
                <table width="100%" style="border:1px solid gray">
                    <tr>
                        <td>
                            <strong>Dirección: </strong>
                            <span t-esc="o.partner_id.street"/>
                            <span t-if="o.partner_id.street and o.partner_id.street2"> / </span>
                            <span t-esc="o.partner_id.street2"/>
                        </td>
                        <td align="right">
                            <strong>Teléfono: </strong>
                            <span t-esc="o.partner_id.phone"/>
                            <span t-if="o.partner_id.phone and o.partner_id.mobile"> / </span>
                            <span t-esc="o.partner_id.mobile"/>
                        </td>
                    </tr>
                </table>
                
                <table width="100%" style="border:1px solid gray">
                    <tr>
                        <td>
                            <strong>Forma de Pago: </strong>
                            <span t-esc="o.payment_mean_id.name"/>
                        </td>
                        <td>
                            <strong>Ciudad: </strong>
                            <span t-esc="o.partner_id.city"/>
                        </td>
                        <td align="right">
                            <strong>País: </strong>
                            <span t-esc="o.partner_id.country_id.name"/>
                        </td>
                    </tr>
                </table>
            </div>
    
            <div class="row">
                <table width="100%" style="border:1px solid gray">
                    <tr>
                        <td width="12%">
                            <strong>Fecha</strong>
                        </td>
                        <td width="12%">
                            <strong>Vence</strong>
                        </td>
                        <td width="12%">
                            <strong>Placa</strong>
                        </td>
                        <td width="12%">
                            <strong>O. Cliente</strong>
                        </td>
                        <td width="12%">
                            <strong>TS</strong>
                        </td>
                        <td width="12%">
                            <strong>N. Control</strong>
                        </td>
                        <td width="12%">
                            <strong>Origen</strong>
                        </td>
                        <td width="16%" align="right">
                            <strong>Factura de Venta</strong>
                        </td>
                    </tr>
                    <tr >
                        <td width="12%">
                            <span t-esc="o.date_invoice"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.date_due"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.vehicle_id.license_plate"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.name"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.service_card"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.control_number"/>
                        </td>
                        <td width="12%">
                            <span t-esc="o.origin"/>
                        </td>
                        <td width="16%" align="right">
                            <span t-esc="o.number"/>
                        </td>
                    </tr>
                </table>
            </div>

            <br/>
            
            <div>
                <table width="100%" style="border:1px solid gray; font-size:11px" >
                    <tr>
                        <td width="15%">
                            <strong>Referencia</strong>
                        </td>
                        <td width="35%">
                            <strong>Description</strong>
                        </td>
                        <td width="10%" align="right">
                            <strong>Cantidad</strong>
                        </td>
                        <td width="13%" align="right">
                            <strong>Precio Unitario</strong>
                        </td>
                        <td width="12%" align="right">
                            <strong>Descuento (%)</strong>
                        </td>
                        <td width="15%" align="right">
                            <strong>Total</strong>
                        </td>
                    </tr>
                    
                    <t t-set="product_kits" t-value="[]"/>
                    <t t-if="any([l.is_product_kit for l in o.invoice_line_ids])">
                        <t t-foreach="o.invoice_line_ids" t-as="l">
                            <t t-if="l.is_product_kit">
                                <t t-set="product_kits" t-value="product_kits + [l.order_kit_line_id]"/>
                            </t>
                        </t>
                    </t>
                    
                    <tr t-foreach="set(product_kits)" t-as="pk">
                        <td width="15%">
                            <span t-esc="pk.product_id.product_tmpl_id.manufacturer_pref if pk.product_id.product_tmpl_id.manufacturer_pref else pk.product_id.default_code"/>
                        </td>
                        <td width="35%">
                            <span t-esc="pk.product_id.name"/>
                        </td>
                        <td width="10%" align="right">
                            <span t-esc="'{0:,.0f}'.format(pk.product_qty)"/>
                        </td>
                        <td width="13%" align="right">
                            <span t-esc="'{0:,.2f}'.format(pk.price_unit)"/>
                        </td>
                        <td width="12%" align="right">
                            <span t-esc="'{0:,.2f}'.format(pk.discount)"/>
                        </td>
                        <td width="15%" align="right">
                            <span t-esc="'{0:,.2f}'.format(pk.product_qty*pk.price_unit - pk.product_qty*pk.price_unit*pk.discount/100)"/>
                        </td>
                    </tr>
                    
                    <tr t-foreach="o.invoice_line_ids" t-as="l">
                        <t t-if="not l.is_product_kit">
                            <td width="15%">
                                <span t-esc="l.product_id.product_tmpl_id.manufacturer_pref and l.product_id.product_tmpl_id.manufacturer_pref or l.product_id.default_code"/>
                            </td>
                            <td width="35%">
                                <span t-esc="l.product_id.name"/>
                            </td>
                            <td width="10%" align="right">
                                <span t-esc="'{0:,.0f}'.format(l.quantity)"/>
                            </td>
                            <td width="13%" align="right">
                                <span t-esc="'{0:,.2f}'.format(l.price_unit)"/>
                            </td>
                            <td width="12%" align="right">
                                <span t-esc="'{0:,.2f}'.format(l.discount)"/>
                            </td>
                            <td width="15%" align="right">
                                <span t-esc="'{0:,.2f}'.format(l.price_subtotal)"/>
                            </td>
                        </t>
                    </tr>
                </table>
                
                <table width="100%" style="border:1px solid gray">
                    <tr>
                        <td width="14%">
                            <strong>Valor</strong>
                            <p>
                                <span t-esc="'{0:,.2f}'.format(o.total_b4_disc)"/>
                            </p>
                        </td>    
                        <td width="14%" align="right">
                            <strong>Descuento</strong>
                            <p>
                                <span t-esc="'{0:,.2f}'.format(o.disc_total)"/>
                            </p>
                        </td>
                        <td width="14%" align="right">
                            <strong>Subtotal</strong>
                            <p>
                                <span t-esc="'{0:,.2f}'.format(o.amount_untaxed)"/>
                            </p>
                        </td>
                        <td width="14%" align="right">
                            <strong>IVA</strong>
                            <p>
                                <t t-set="valor_impuesto" t-value="0"/>
                                <t t-foreach="o._get_tax_amount_by_group()" t-as="amount_by_group">
                                    <t t-set="impuesto" t-value="amount_by_group[0]"/>
                                    <t t-set="valor_impuesto" t-value="impuesto == 'IVA' and valor_impuesto + amount_by_group[1] or valor_impuesto + 0"/>
                                </t>
                                <span t-esc="'{0:,.2f}'.format(valor_impuesto)"/>
                            </p>
                        </td>
                        <td width="14%" align="right">
                            <strong>-RETEFUENTE</strong>
                            <p>
                                <t t-set="valor_impuesto" t-value="0"/>
                                <t t-foreach="o._get_tax_amount_by_group()" t-as="amount_by_group">
                                    <t t-set="impuesto" t-value="amount_by_group[0]"/>
                                    <t t-set="impuesto" t-value="impuesto[:10]"/>
                                    <t t-set="valor_impuesto" t-value="impuesto == 'RETEFUENTE' and valor_impuesto + amount_by_group[1] or valor_impuesto + 0"/>
                                </t>
                                <span t-esc="'{0:,.2f}'.format(valor_impuesto)"/>
                            </p>
                        </td>
                        <td width="14%" align="right">
                            <strong>-RETEIVA</strong>
                            <p>
                                <t t-set="valor_impuesto" t-value="0"/>
                                <t t-foreach="o._get_tax_amount_by_group()" t-as="amount_by_group">
                                    <t t-set="impuesto" t-value="amount_by_group[0]"/>
                                    <t t-set="impuesto" t-value="impuesto[:7]"/>
                                    <t t-set="valor_impuesto" t-value="impuesto == 'RETEIVA' and valor_impuesto + amount_by_group[1] or valor_impuesto + 0"/>
                                </t>
                                <span t-esc="'{0:,.2f}'.format(valor_impuesto)"/>
                            </p>
                        </td>
                        <td width="16%" align="right">
                            <strong>Total a Pagar</strong>
                            <p>
                                <span t-esc="o.currency_id.name"/>
                                <span t-esc="'{0:,.2f}'.format(o.amount_total)"/>
                            </p>
                        </td>
                    </tr>
                </table>
            </div>
            
            <br/>
    
            <div class="row">
                <table width="100%">
                    <tr>
                        <td>
                            <p style="font-size:15px" align="justify">
                                <strong>EXA Auto Parts S.A.S / Nombre comercial TURBO DIESEL.</strong>
                            </p>
                            
                            <p style="font-size:11px" align="justify">
                                Resolución de facturación impresa por computador con Número de formulario 18762016315771. Fecha de expedición Agosto 15 de 2019. Rango autorizado EXA30267 a EXA33267. Vigencia 24 meses contados a partir de la expedición. IVA REGIMEN COMUN - ICA 306 10 x 1000 Ingresos declarados en Medellín - No somos Grandes contribuyentes - No somos autoretenedores CIIU 4520 0.4%
                            </p>
                            
                            <p style="font-size:11px" align="justify">
                                Se autoriza consignar o hacer transferencia electrónica a las siguientes cuentas bancarias: Bancolombia Cta Corriente: 021.942.325.01, Banco de Occidente Cta Corriente 480.530.245. Elaborar cheque al PRIMER BENEFICIARIO a favor de EXA Auto Parts S.A.S, en el cual debe ser entregado solo al personal autorizado por EXA Auto Parts S.A.S.
                            </p>
                            
                            <p style="font-size:11px" align="justify">
                                Esta factura de venta se asimila en todos sus efectos a una letra de cambio, según lo establece el código de comercio. El incumplimiento del pago en el plazo pactado generará intereses de mora después de la fecha de vencimiento a la tasa máxima permitida por la ley. Autorizo(amos) a EXA Auto Parts S.A.S, para que mi información sea consultada por terceros autorizados por la ley 1266 de 2008, igualmente para que este sea reportado en las centrales de riesgos (DataCrédito - ProCrédito). <strong>Garantía:</strong> Bomba de inyección e inyectores: 6 meses. Turbo alimentador: 3 meses sólo por paso de aceite, mas no por rotura de piezas. Partes eléctricas no tienen garantía. <strong>Condiciones para cubrir la garantía:</strong> 1. La garantia cubre solamente los repuestos y mano de obra que se le detallan en la factura. 2. No se cubren daños causados al motor y/o sus componentes y demás partes del vehículo. 3. No se cubren daños causados por uso de combustible contaminado. 4. La garantía se pierde si los productos son manipulados por personal no autorizado por EXA Auto Parts S.A.S. <strong>Recomendaciones:</strong> 1. Usar filtros de buena calidad así como hacer los cambios de estos en los tiempos adecuados. 2. Hacer revisión periódica al tanque de combustible a fin de evitar contaminación por partículas extranas que afecten el sistema de inyección.
                            </p>
                        </td>
                    </tr>
                </table>
                
                <br/>
                
                <table width="100%" style="font-size:11px">
                    <tr>
                        <td>
                            <p>Recibí el producto o servicio: Si __ No __, Acepto la factura Si __ No __</p>
                            <p>Nombre: ____________________________________________________________</p>
                            <p>Firma y C.C.: __________________________ Fecha: ______________________</p>
                        </td>
                        <td align="right">
                            <p>Fecha de Impresion: <span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></p>
                            <p><strong>ORIGINAL</strong></p>
                            <p><strong>Asesor Comercial: </strong><span t-esc="o.user_id.partner_id.name"/></p>
                            <p t-if="o.partner_id.commercial_name">
                                <strong>Nombre Comercial: </strong><span t-esc="o.partner_id.commercial_name"/>
                            </p>
                        </td>
                    </tr>
                </table>
                
                <br/>
                
                <p t-if="o.comment" align="justify" style="font-size:11px">
                    <strong>Observaciones: </strong>
                </p>
                <p t-if="o.comment" align="justify" style="font-size:11px">
                    <span t-esc="o.comment"/>
                </p>
            </div>
        </div>
        
        <div class="footer">
            <div class="row">
                <div class="col-xs-2 pull-right">
                    <small>
                        <center>
                            <span>Página</span>
                            <span class="page"/>
                            de
                            <span class="topage"/>
                        </center>
                    </small>
                </div>
            </div>
        </div>
    </t>
</t>
</template>
<report 
        id="report_account_einvoice_with_qr"
        model="account.invoice"
        string="eInvoice Report"
        report_type="qweb-pdf"
        name="l10n_co_e_invoicing.report_invoice_qr"
        file="l10n_co_e_invoicing.report_account_invoice_with_qr"
/>
</data>
</odoo>
